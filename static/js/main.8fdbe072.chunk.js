(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{336:function(e,t,n){e.exports=n(602)},344:function(e,t,n){},352:function(e,t,n){},594:function(e,t,n){},596:function(e,t,n){},602:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(64),c=n.n(o),i=(n(344),n(13)),s=n.n(i),u=n(24),l=n(35),h=n(36),p=n(48),d=n(49),f=n(51),m=n(66),b=(n(352),n(109)),v=n(110),g=n(67),w=n(335),k=n(155),E=n.n(k),y={oauthLoginURL:"https://d945ipi8b7.execute-api.us-east-1.amazonaws.com/dev/oauth_login",userBasedRecommendURL:"https://d945ipi8b7.execute-api.us-east-1.amazonaws.com/dev/user_rcmd",similarRepoAPIURL:"https://k8rgby9lr1.execute-api.us-east-1.amazonaws.com/dev/repo/similar"},_=void 0,O=E.a.create({baseURL:"https://api.github.com"}),j=E.a.create({baseURL:y.similarRepoAPIURL});function x(){return R.apply(this,arguments)}function R(){return(R=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_){e.next=2;break}throw new Error("github login required for `getUserBasedRecommend`");case 2:return e.next=4,E.a.get("".concat(y.userBasedRecommendURL,"?limit=20&ghToken=").concat(_));case 4:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function L(e){return U.apply(this,arguments)}function U(){return(U=Object(u.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get("/user?access_token=".concat(t));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function S(e){return I.apply(this,arguments)}function I(){return(I=Object(u.a)(s.a.mark(function e(t){var n,r,a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get(t||"/user/starred?page=1");case 2:return n=e.sent,c=n.headers.link||"",i=void 0,void 0,void 0,void 0,void 0,void 0,void 0,s=c.split(/<(.+?)>;\s*rel="(.+?)",\s*<(.+?)>;\s*rel="(.+?)"/),u=Object(w.a)(s,5),l=u[1],h=u[2],p=u[3],d=u[4],i={},Object(g.a)(i,h,l),Object(g.a)(i,d,p),a=(r=i).next,o=r.last,e.abrupt("return",{data:n.data,nextStarPageURL:o===t?void 0:a});case 5:case"end":return e.stop()}var c,i,s,u,l,h,p,d},e,this)}))).apply(this,arguments)}function N(e){return T.apply(this,arguments)}function T(){return(T=Object(u.a)(s.a.mark(function e(t){var n,r,a,o=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:0,r=o.length>2&&void 0!==o[2]?o[2]:5,e.next=4,j.get("/?rid=".concat(t,"&limit=").concat(n+r));case 4:return a=e.sent.data,e.abrupt("return",a.slice(n,a.length));case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function P(e){return C.apply(this,arguments)}function C(){return(C=Object(u.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get("repositories/".concat(t));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function M(e){return B.apply(this,arguments)}function B(){return(B=Object(u.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get("/repos/".concat(t,"/languages"));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var A=function(){return window.localStorage.getItem("TokenLocalstorageKey")},G=n(88),D=n(43),z=n.n(D),H=n(297),W=n(14);n(594);var q=n(114),X=function(){function e(){Object(l.a)(this,e),this._pool=[],this._nextPageURL=void 0,this.reachedEnd=!1}var t;return Object(h.a)(e,[{key:"pop",value:(t=Object(u.a)(s.a.mark(function e(t){var n,r,a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.reachedEnd){e.next=2;break}return e.abrupt("return",[]);case 2:if(!(this._pool.length>=t)){e.next=4;break}return e.abrupt("return",this._pool.splice(0,t));case 4:return e.next=6,S(this._nextPageURL);case 6:return r=e.sent,a=r.data,o=r.nextStarPageURL,this.reachedEnd=this._nextPageURL===o,this._nextPageURL=o,(n=this._pool).push.apply(n,Object(q.a)(a)),e.abrupt("return",this._pool.splice(0,t));case 13:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),e}(),V=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};Object(l.a)(this,e),this._grow=function(){var e=Object(u.a)(s.a.mark(function e(n){var r,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t._recommendoPool.splice(0,n)).length!==n){e.next=7;break}return e.next=4,t._populateListo(r);case 4:return e.abrupt("return");case 7:if(!(r.length>0)){e.next=11;break}return e.next=10,t._populateListo(r);case 10:n-=r.length;case 11:return e.next=13,t.starSource.pop(n);case 13:if((a=e.sent).forEach(function(e){return t.repoDetails[e.id]=e}),0!==a.length){e.next=20;break}t.reachedEnd=!0,t.onUpdate(),e.next=24;break;case 20:return e.next=22,Promise.all(a.map(function(){var e=Object(u.a)(s.a.mark(function e(n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.t1=n.id,e.next=4,N(n.id);case 4:e.t2=e.sent,e.t0._populateRecommendoPool.call(e.t0,e.t1,e.t2);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 22:return e.next=24,t._populateListo(t._recommendoPool.splice(0,n));case 24:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),this.onUpdate=n,this.starSource=new X,this._recommendoPool=[],this._listos=[],this.reachedEnd=!1,this.repoDetails={}}var t,n,r,a;return Object(h.a)(e,[{key:"listos",value:function(){return Object(q.a)(this._listos)}},{key:"_populateRecommendoPool",value:function(e,t){var n;(n=this._recommendoPool).push.apply(n,Object(q.a)(t.map(function(t){return{from_rid:e,to_rid:t.rid,score:t.sim}})))}},{key:"_populateListo",value:(a=Object(u.a)(s.a.mark(function e(t){var n,r,a=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=z.a.map(this._listos,"to_rid").filter(function(e){return!!e}),r=z.a.reject(t,function(e){return z.a.includes(n,e.to_rid)}),e.next=4,Promise.all(r.map(function(){var e=Object(u.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t.to_rid).catch(function(){});case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:a.repoDetails[t.to_rid]=n,a._listos.push(t);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 4:this.onUpdate();case 5:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"showMoreOf",value:(r=Object(u.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.busy){e.next=2;break}return e.abrupt("return");case 2:return this.busy=!0,this.onUpdate(),e.prev=4,e.next=7,this._showMoreOf(t);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.error(e.t0);case 12:this.busy=!1,this.onUpdate();case 14:case"end":return e.stop()}},e,this,[[4,9]])})),function(e){return r.apply(this,arguments)})},{key:"_showMoreOf",value:(n=Object(u.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=this._recommendoPool.filter(function(e){return e.from_rid===t})).length>0)){e.next=5;break}return this._listos=z.a.flatmap(this._listos,function(e){return e.to_rid===t?[e].concat(Object(q.a)(n)):[e]}),this.onUpdate(),e.abrupt("return");case 5:return e.next=7,N(t,this._listos.filter(function(e){return e.from_rid===t}).length);case 7:return r=e.sent,e.next=10,this._populateListo(r.map(function(e){return{from_rid:t,to_rid:e.rid,score:e.sim}}));case 10:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"grow",value:(t=Object(u.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.busy&&!this.reachedEnd){e.next=2;break}return e.abrupt("return");case 2:return this.busy=!0,this.onUpdate(),e.prev=4,e.next=7,this._grow(t);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.error(e.t0);case 12:this.busy=!1,this.onUpdate();case 14:case"end":return e.stop()}},e,this,[[4,9]])})),function(e){return t.apply(this,arguments)})}]),e}(),J=n(108),K=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(p.a)(this,Object(d.a)(t).call(this))).handleLogout=e.handleLogout.bind(Object(J.a)(Object(J.a)(e))),e}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleLogout",value:function(){this.props.dispatch({type:"SET_GH_USER",access_token:void 0,user:void 0}),window.location.href="/"}},{key:"renderUserAvatar",value:function(){return a.a.createElement("div",null,a.a.createElement(W.j.Item,null,a.a.createElement(W.f,{size:"mini",circular:!0,src:this.props.user.avatar_url})))}},{key:"renderLoggedIn",value:function(){return a.a.createElement(W.k,{wide:!0,trigger:this.renderUserAvatar(),on:"click",position:"bottom center"},a.a.createElement(W.j,{fluid:!0,vertical:!0},a.a.createElement(W.j.Item,{onClick:this.handleLogout},"Logout")))}},{key:"renderNotLogIn",value:function(){return null}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(W.j,{pointing:!0,secondary:!0},a.a.createElement(W.j.Item,{name:"Twinkeydow",as:"a",href:v("https://max0ne.github.io/twinkeydow").pathname}),a.a.createElement(W.j.Menu,{position:"right"},this.props.user?this.renderLoggedIn():this.renderNotLogIn())))}}]),t}(r.Component),F=Object(m.b)(function(e){return{user:e.user}})(K),Q=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(p.a)(this,Object(d.a)(t).call(this))).showMore=Object(u.a)(s.a.mark(function t(){var n,r,a=arguments;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=a.length>0&&void 0!==a[0]?a[0]:30,console.log("show more"),e.state.reachedEnd?(r=z.a.uniq(e.listoSource.listos().map(function(e){return e.to_rid})),z.a.range(5).forEach(function(){return e.listoSource.showMoreOf(r[Math.floor(Math.random()*r.length)])})):e.listoSource.grow(n);case 3:case"end":return t.stop()}},t,this)})),e.getRepoLanguages=function(){var t=Object(u.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(z.a.has(e.state.repoLangs,n.id)){t.next=5;break}return t.next=3,M("".concat(n.owner.login,"/").concat(n.name));case 3:r=t.sent,e.setState(function(e){return Object(G.a)({},e,{repoLangs:Object(G.a)({},e.repoLangs,Object(g.a)({},n.id,r))})});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.renderRecommendRepo=function(t){var n=e.listoSource.repoDetails;return e.renderRepo(n[t.to_rid],n[t.from_rid],t.score)},e.state={listos:[],repoLangs:{},userBasedRepos:[],reachedEnd:!1},e.showMore=z.a.throttle(e.showMore,1e3),e.firstRender=!0,e.listoSource=new V(function(){e.firstRender&&(e.firstRender=!1);var t=e.listoSource.listos();e.setState({listos:t,reachedEnd:e.listoSource.reachedEnd}),t.forEach(function(t){return e.getRepoLanguages(e.listoSource.repoDetails[t.to_rid])})}),e.showMore(10),e}var n;return Object(f.a)(t,e),Object(h.a)(t,[{key:"reloadUserBasedRecommends",value:(n=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=this,e.t1=Promise,e.next=5,x();case 5:if(e.t2=e.sent.rids,e.t2){e.next=8;break}e.t2=[];case 8:return e.t3=P,e.t4=e.t2.map(e.t3),e.next=12,e.t1.all.call(e.t1,e.t4);case 12:e.t5=e.sent,e.t6={userBasedRepos:e.t5},e.t0.setState.call(e.t0,e.t6),e.next=20;break;case 17:e.prev=17,e.t7=e.catch(0),t=e.t7,Object(b.toast)(t.response&&t.response.body&&t.response.body.status||t.toString());case 20:case"end":return e.stop()}var t},e,this,[[0,17]])})),function(){return n.apply(this,arguments)})},{key:"renderUserStar",value:function(e){return a.a.createElement(W.g,{key:e.id},a.a.createElement(W.g.Image,{size:"tiny",src:(e.owner||{}).avatar_url,circular:!0}),a.a.createElement(W.g.Content,null,a.a.createElement(W.g.Header,{as:"a",href:e.html_url},e.full_name),a.a.createElement(W.g.Meta,null,"".concat(e.owner.login,"/").concat(e.description)),a.a.createElement(W.g.Extra,null,(e.topics||[]).join(" "))))}},{key:"renderRepo",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=this.state.repoLangs[e.id]||(e.language?Object(g.a)({},e.language,1):{}),r=Object.keys(n).filter(function(e){return!z.a.isNil(e)}).sort(function(e,t){return n[t]-n[e]}).slice(0,2);return a.a.createElement("div",{className:"repo-container",key:e.id},a.a.createElement(W.b,{href:e.html_url,target:"_blank",rel:"noopener noreferrer"},a.a.createElement(W.b.Content,null,a.a.createElement(W.b.Header,{className:"home-repo-name"},a.a.createElement(W.f,{className:"home-repo-avatar",circular:!0,src:e.owner&&e.owner.avatar_url||""}),e.full_name),r.map(function(e){return a.a.createElement(W.h,{key:e,style:{background:(H[e]||{}).color,color:"white"},size:"tiny"},e)}),a.a.createElement(W.b.Description,null,e.description)),t&&a.a.createElement(W.b.Content,{extra:!0},a.a.createElement(W.e,{name:"heart"}),"similar to ",t.full_name)))}},{key:"renderNoRecommendAvailable",value:function(){return a.a.createElement("div",null,a.a.createElement(W.d,{as:"h1",icon:!0,textAlign:"center"},a.a.createElement(W.d.Content,null,a.a.createElement("span",{role:"img","aria-label":"not found"},"\ud83e\udd37"))),a.a.createElement(W.d,{as:"h3",textAlign:"center"},a.a.createElement("p",null,"Sorry you don't have enough interactions on Github."),a.a.createElement("p",null,a.a.createElement("a",{href:"https://github.com/explore",target:"_blank",rel:"noopener noreferrer"},"Go star some repos you like and come back later"))))}},{key:"renderLoading",value:function(){return a.a.createElement(W.i,{active:!0},"Loading")}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(F,null),a.a.createElement("div",{className:"recommendation-content-container"},this.renderItemBased()))}},{key:"renderItemBased",value:function(){var e=this;if(0===this.state.listos.length)return this.state.reachedEnd?this.renderNoRecommendAvailable():this.renderLoading();var t=Math.max(Math.ceil(document.body.clientWidth/400),1);return a.a.createElement(W.l,{onUpdate:function(){return e.forceUpdate()}},a.a.createElement(W.c,{columns:t,centered:!0},z.a.range(t).map(function(n){return a.a.createElement(W.c.Column,{key:n},e.state.listos.filter(function(e,r){return r%t===n}).map(e.renderRecommendRepo))})),a.a.createElement(W.m,{offset:[10,100],onOnScreen:this.showMore,once:!1,fireOnMount:!0},a.a.createElement(W.b.Group,null,a.a.createElement(W.b,{fluid:!0,color:"orange",style:{height:50},onClick:this.showMore,centered:!0},this.listoSource.busy?a.a.createElement(W.i,{active:!0}):a.a.createElement(W.b.Content,null,"Load More")))))}},{key:"renderUserBased",value:function(){var e=this;return a.a.createElement(W.g.Group,null,this.state.userBasedRepos.map(function(t){return e.renderRepo(t)}))}}]),t}(r.Component),$=Object(m.b)(function(e){return{user:e.user}})(Q),Y=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,"Validating OAuth callback...")}}]),t}(r.Component),Z=(n(596),function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e="".concat(y.oauthLoginURL,"?oauth_done_redirect=").concat(encodeURIComponent(window.location.href));return a.a.createElement("div",{className:"welcome-container"},a.a.createElement("h1",{className:"welcome-logo"},a.a.createElement("span",{role:"img","aria-label":"welcome"},"\ud83d\ude4b")," hi welcome to project Twinkeydow"),a.a.createElement("h5",null,"it gives you personalized Github repo recommendations"),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(W.a,{as:"a",href:e},a.a.createElement(W.e,{name:"github"}),"Try it!",a.a.createElement("br",null),"Login through Github"))}}]),t}(r.Component)),ee=n(90),te=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).redirectIfNecessary=Object(u.a)(s.a.mark(function e(){var t,r,a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=function e(){if(!n.history)return setTimeout(e,100);window.location.href.endsWith("/welcome")||n.history.push("/welcome")},r=function e(){if(!n.history)return setTimeout(e,100);window.location.href.endsWith("/home")||n.history.push("/home")},e.prev=2,a=v(window.location.href,!0).query.access_token||v(window.location.href.split("#")[1],!0).query.access_token||A()){e.next=6;break}return e.abrupt("return",t());case 6:return n.props.dispatch({type:"SET_GH_USER",access_token:a}),e.next=9,L(a);case 9:o=e.sent,n.props.dispatch({type:"SET_GH_USER",access_token:a,user:o}),r(),e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",t());case 18:case"end":return e.stop()}},e,this,[[2,14]])})),n.redirectIfNecessary(),n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"app"},a.a.createElement(b.ToastContainer,{position:"top-center",hideProgressBar:!0}),a.a.createElement(ee.a,{ref:function(t){e.history=t.history}},a.a.createElement(ee.c,null,a.a.createElement(ee.b,{path:"/home",component:$}),a.a.createElement(ee.b,{path:"/welcome",component:Z}),a.a.createElement(ee.b,{path:"/oauth_done",component:Y}))))}}]),t}(r.Component),ne=Object(m.b)()(te),re=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ae(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var oe=n(113),ce=(n(599),Object(oe.c)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentUser:void 0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GH_USER":return Object(G.a)({},e,{access_token:t.access_token,user:t.user});case"CLEAR_GH_USER":return Object(G.a)({},e,{access_token:void 0,user:void 0});default:return e}},window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Object(oe.a)(function(e){return function(t){return function(n){var r,a=t(n);if("SET_GH_USER"===n.type){var o=e.getState().access_token;r=o,O.defaults.headers.Authorization="Bearer ".concat(r),_=r,window.localStorage.setItem("TokenLocalstorageKey",o)}return a}}})));c.a.render(a.a.createElement(m.a,{store:ce},a.a.createElement(ne,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("https://max0ne.github.io/twinkeydow",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("https://max0ne.github.io/twinkeydow","/service-worker.js");re?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ae(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ae(e)})}}()}},[[336,2,1]]]);
//# sourceMappingURL=main.8fdbe072.chunk.js.map