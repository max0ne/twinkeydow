(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{337:function(e,t,n){e.exports=n(603)},345:function(e,t,n){},353:function(e,t,n){},595:function(e,t,n){},597:function(e,t,n){},603:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(67),c=n.n(o),i=(n(345),n(16)),s=n.n(i),u=n(25),l=n(28),p=n(36),d=n(42),h=n(43),m=n(44),f=n(69),b=(n(353),n(110)),v=n(111),g=n(52),w=n(336),E=n(155),k=n.n(E),O={oauthLoginURL:"https://d945ipi8b7.execute-api.us-east-1.amazonaws.com/dev/oauth_login",userBasedRecommendURL:"https://d945ipi8b7.execute-api.us-east-1.amazonaws.com/dev/user_rcmd",similarRepoAPIURL:"https://k8rgby9lr1.execute-api.us-east-1.amazonaws.com/dev/repo/similar"},y=k.a.create({baseURL:"https://api.github.com"}),j=k.a.create({baseURL:O.similarRepoAPIURL});function _(e){return x.apply(this,arguments)}function x(){return(x=Object(u.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.get("/user?access_token=".concat(t));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function L(e){return R.apply(this,arguments)}function R(){return(R=Object(u.a)(s.a.mark(function e(t){var n,r,a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.get(t||"/user/starred?page=1");case 2:return n=e.sent,c=n.headers.link||"",i=void 0,void 0,void 0,void 0,void 0,void 0,void 0,s=c.split(/<(.+?)>;\s*rel="(.+?)",\s*<(.+?)>;\s*rel="(.+?)"/),u=Object(w.a)(s,5),l=u[1],p=u[2],d=u[3],h=u[4],i={},Object(g.a)(i,p,l),Object(g.a)(i,h,d),a=(r=i).next,o=r.last,e.abrupt("return",{data:n.data,nextStarPageURL:o===t?void 0:a});case 5:case"end":return e.stop()}var c,i,s,u,l,p,d,h},e,this)}))).apply(this,arguments)}function S(e){return U.apply(this,arguments)}function U(){return(U=Object(u.a)(s.a.mark(function e(t){var n,r,a,o=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:0,r=o.length>2&&void 0!==o[2]?o[2]:5,e.next=4,j.get("/?rid=".concat(t,"&limit=").concat(n+r));case 4:return a=e.sent.data,e.abrupt("return",a.slice(n,a.length));case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function I(e){return N.apply(this,arguments)}function N(){return(N=Object(u.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.get("repositories/".concat(t));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function C(e){return T.apply(this,arguments)}function T(){return(T=Object(u.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.get("/repos/".concat(t,"/languages"));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var D=function(){return window.localStorage.getItem("TokenLocalstorageKey")},M=n(59),A=n(33),G=n.n(A),B=n(297),P=n(14),W=n(331),z=(n(595),n(60)),H=function(){function e(){Object(l.a)(this,e),this._pool=[],this._nextPageURL=void 0,this.reachedEnd=!1}var t;return Object(p.a)(e,[{key:"pop",value:(t=Object(u.a)(s.a.mark(function e(t){var n,r,a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.reachedEnd){e.next=2;break}return e.abrupt("return",[]);case 2:if(!(this._pool.length>=t)){e.next=4;break}return e.abrupt("return",this._pool.splice(0,t));case 4:return e.next=6,L(this._nextPageURL);case 6:return r=e.sent,a=r.data,o=r.nextStarPageURL,this.reachedEnd=this._nextPageURL===o,this._nextPageURL=o,(n=this._pool).push.apply(n,Object(z.a)(a)),e.abrupt("return",this._pool.splice(0,t));case 13:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),e}(),X=function e(){var t=this;Object(l.a)(this,e),this.loadMoreOf=function(){var e=Object(u.a)(s.a.mark(function e(n){var r,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.repoStates[n]="loading",t.similarRepos[n]=t.similarRepos[n]||[],e.next=4,S(n,G.a.size(t.similarRepos[n]));case 4:return a=e.sent,(r=t.similarRepos[n]).push.apply(r,Object(z.a)(a)),t.repoStates[n]="loaded",e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),this.similarRepos={},this.repoStates={}},q=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).componentDidMount=function(){n.loadMore(10)},n.loadRepoDetail=function(){var e=Object(u.a)(s.a.mark(function e(t){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t);case 2:r=e.sent,n.setState(function(e){return{repoDetails:Object(M.a)({},e.repoDetails,Object(g.a)({},t,r))}});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.loadMore=function(){var e=Object(u.a)(s.a.mark(function e(t){var r,a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.loading){e.next=2;break}return e.abrupt("return");case 2:n.loading=!0,n.setState({loading:!0}),e.prev=4,r=10,a=[];case 7:return e.next=10,n._loadMore();case 10:if(o=e.sent,G.a.map(o,"to_rid").forEach(n.loadRepoDetail),a.push.apply(a,Object(z.a)(o)),n.setState({recommends:Object(z.a)(n.state.recommends).concat(a)}),!(0===--r||a.length>=t)){e.next=16;break}return e.abrupt("break",18);case 16:e.next=7;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),console.error(e.t0);case 23:n.setState({loading:!1}),n.loading=!1;case 25:case"end":return e.stop()}},e,this,[[4,20]])}));return function(t){return e.apply(this,arguments)}}(),n._loadMore=Object(u.a)(s.a.mark(function e(){var t,r,a,o,c,i,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],n.sourceLoader.reachedEnd){e.next=11;break}return e.next=4,n.sourceLoader.pop(10);case 4:r=e.sent,a={},r.forEach(function(e){a[e.id]=e}),n.setState({repoDetails:Object(M.a)({},n.state.repoDetails,a)}),t=G.a.map(r,"id"),e.next=13;break;case 11:o=Object(z.a)(new Set(G.a.map(n.state.recommends,"from_rid"))),t=G.a.range(5).map(function(){return o[G.a.random(o.length-1)]});case 13:return c=[],e.next=16,Promise.all(t.map(function(){var e=Object(u.a)(s.a.mark(function e(t){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.similarLoader.loadMoreOf(t);case 2:r=e.sent,c.push.apply(c,Object(z.a)(r.map(function(e){return{from_rid:t,to_rid:e.rid,score:e.sim}})));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 16:return i=new Set(G.a.map(n.state.recommends,"to_rid")),l=G.a.uniqBy(c,"to_rid").filter(function(e){return!i.has(e.to_rid)}),e.abrupt("return",l);case 19:case"end":return e.stop()}},e,this)})),n.sourceLoader=new H,n.similarLoader=new X,n.state={repoDetails:{},recommends:[],loading:!1},n.loading=!1,n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.props.children({loadMore:this.loadMore,repoDetails:this.state.repoDetails,recommends:this.state.recommends,loading:this.state.loading})}}]),t}(a.a.Component),V=n(109);var J=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).handleLogout=e.handleLogout.bind(Object(V.a)(Object(V.a)(e))),e}return Object(m.a)(t,e),Object(p.a)(t,[{key:"handleLogout",value:function(){this.props.dispatch({type:"SET_GH_USER",access_token:void 0,user:void 0}),window.location.href="/"}},{key:"renderUserAvatar",value:function(){return a.a.createElement("div",null,a.a.createElement(P.i.Item,null,a.a.createElement(P.f,{size:"mini",circular:!0,src:this.props.user.avatar_url})))}},{key:"renderLoggedIn",value:function(){return a.a.createElement(P.j,{wide:!0,trigger:this.renderUserAvatar(),on:"click",position:"bottom center"},a.a.createElement(P.i,{fluid:!0,vertical:!0},a.a.createElement(P.i.Item,{onClick:this.handleLogout},"Logout")))}},{key:"renderNotLogIn",value:function(){return null}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(P.i,{pointing:!0,secondary:!0},a.a.createElement(P.i.Item,{name:"Twinkeydow",as:"a",href:v("https://max0ne.github.io/twinkeydow").pathname}),a.a.createElement(P.i.Menu,{position:"right"},this.props.user?this.renderLoggedIn():this.renderNotLogIn())))}}]),t}(r.Component),K=Object(f.b)(function(e){return{user:e.user}})(J),F=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).getRepoLanguages=function(){var t=Object(u.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(G.a.has(e.state.repoLangs,n.id)){t.next=5;break}return t.next=3,C("".concat(n.owner.login,"/").concat(n.name));case 3:r=t.sent,e.setState(function(e){return Object(M.a)({},e,{repoLangs:Object(M.a)({},e.repoLangs,Object(g.a)({},n.id,r))})});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.renderItemBasedWithData=function(t){var n=t.loadMore,r=t.repoDetails,o=t.recommends,c=t.loading;if(0===o.length)return c?e.renderLoading():e.renderNoRecommendAvailable();var i=Math.max(Math.ceil(document.body.clientWidth/400),1);return n=n.bind(3*i),a.a.createElement(P.k,{onUpdate:function(){return e.forceUpdate()}},a.a.createElement(P.c,{columns:i,centered:!0},G.a.range(i).map(function(t){return a.a.createElement(P.c.Column,{key:t},o.filter(function(e,n){return n%i===t}).map(function(t,n){return e.renderRepo(n,r[t.to_rid],r[t.from_rid])}))})),a.a.createElement(P.l,{offset:[10,100],onOnScreen:n,once:!1,fireOnMount:!0},a.a.createElement(P.b.Group,null,a.a.createElement(P.b,{color:"orange",style:{height:50},onClick:n,centered:!0},c?a.a.createElement(P.h,{active:!0}):a.a.createElement(P.b.Content,null,"Load More")))))},e.state={repoLangs:{}},e}return Object(m.a)(t,e),Object(p.a)(t,[{key:"renderRepo",value:function(e,t,n){if(G.a.isNil(t))return a.a.createElement("div",{className:"repo-container",key:e},a.a.createElement(P.b,null,a.a.createElement(W.a,null),a.a.createElement(P.b.Content,{extra:!0},a.a.createElement(P.e,{name:"sync"}),"It's loading...")));var r=this.state.repoLangs[t.id]||(t.language?Object(g.a)({},t.language,1):{}),o=Object.keys(r).filter(function(e){return!G.a.isNil(e)}).sort(function(e,t){return r[t]-r[e]}).slice(0,2);return a.a.createElement("div",{className:"repo-container",key:t.id},a.a.createElement(P.b,{href:t.html_url,target:"_blank",rel:"noopener noreferrer"},a.a.createElement(P.b.Content,null,a.a.createElement(P.b.Header,{className:"home-repo-name"},a.a.createElement(P.f,{className:"home-repo-avatar",circular:!0,src:t.owner&&t.owner.avatar_url||""}),t.full_name),o.map(function(e){return a.a.createElement(P.g,{key:e,style:{background:(B[e]||{}).color,color:"white"},size:"tiny"},e)}),a.a.createElement(P.b.Description,null,t.description)),n&&a.a.createElement(P.b.Content,{extra:!0},a.a.createElement(P.e,{name:"heart"}),"similar to ",n.full_name)))}},{key:"renderNoRecommendAvailable",value:function(){return a.a.createElement("div",null,a.a.createElement(P.d,{as:"h1",icon:!0,textAlign:"center"},a.a.createElement(P.d.Content,null,a.a.createElement("span",{role:"img","aria-label":"not found"},"\ud83e\udd37"))),a.a.createElement(P.d,{as:"h3",textAlign:"center"},a.a.createElement("p",null,"Sorry you don't have enough interactions on Github."),a.a.createElement("p",null,a.a.createElement("a",{href:"https://github.com/explore",target:"_blank",rel:"noopener noreferrer"},"Go star some repos you like and come back later"))))}},{key:"renderLoading",value:function(){return a.a.createElement(P.h,{active:!0},"Loading")}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(K,null),a.a.createElement("div",{className:"recommendation-content-container"},this.renderItemBased()))}},{key:"renderItemBased",value:function(){return a.a.createElement(q,null,this.renderItemBasedWithData)}}]),t}(r.Component),Q=Object(f.b)(function(e){return{user:e.user}})(F),$=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,"Validating OAuth callback...")}}]),t}(r.Component),Y=(n(597),function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e="".concat(O.oauthLoginURL,"?oauth_done_redirect=").concat(encodeURIComponent(window.location.href));return a.a.createElement("div",{className:"welcome-container"},a.a.createElement("h1",{className:"welcome-logo"},a.a.createElement("span",{role:"img","aria-label":"welcome"},"\ud83d\ude4b")," hi welcome to project Twinkeydow"),a.a.createElement("h5",null,"it gives you personalized Github repo recommendations"),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(P.a,{as:"a",href:e},a.a.createElement(P.e,{name:"github"}),"Try it!",a.a.createElement("br",null),"Login through Github"))}}]),t}(r.Component)),Z=n(91),ee=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).redirectIfNecessary=Object(u.a)(s.a.mark(function e(){var t,r,a,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=function e(){if(!n.history)return setTimeout(e,100);window.location.href.endsWith("/welcome")||n.history.push("/welcome")},r=function e(){if(!n.history)return setTimeout(e,100);window.location.href.endsWith("/home")||n.history.push("/home")},e.prev=2,a=v(window.location.href,!0).query.access_token||v(window.location.href.split("#")[1],!0).query.access_token||D()){e.next=6;break}return e.abrupt("return",t());case 6:return n.props.dispatch({type:"SET_GH_USER",access_token:a}),e.next=9,_(a);case 9:o=e.sent,n.props.dispatch({type:"SET_GH_USER",access_token:a,user:o}),r(),e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",t());case 18:case"end":return e.stop()}},e,this,[[2,14]])})),n.redirectIfNecessary(),n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"app"},a.a.createElement(b.ToastContainer,{position:"top-center",hideProgressBar:!0}),a.a.createElement(Z.a,{ref:function(t){e.history=t.history}},a.a.createElement(Z.c,null,a.a.createElement(Z.b,{path:"/home",component:Q}),a.a.createElement(Z.b,{path:"/welcome",component:Y}),a.a.createElement(Z.b,{path:"/oauth_done",component:$}))))}}]),t}(r.Component),te=Object(f.b)()(ee),ne=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function re(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var ae=n(114),oe=(n(600),Object(ae.c)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentUser:void 0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GH_USER":return Object(M.a)({},e,{access_token:t.access_token,user:t.user});case"CLEAR_GH_USER":return Object(M.a)({},e,{access_token:void 0,user:void 0});default:return e}},window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Object(ae.a)(function(e){return function(t){return function(n){var r,a=t(n);if("SET_GH_USER"===n.type){var o=e.getState().access_token;r=o,y.defaults.headers.Authorization="Bearer ".concat(r),r,window.localStorage.setItem("TokenLocalstorageKey",o)}return a}}})));c.a.render(a.a.createElement(f.a,{store:oe},a.a.createElement(te,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("https://max0ne.github.io/twinkeydow",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("https://max0ne.github.io/twinkeydow","/service-worker.js");ne?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):re(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):re(e)})}}()}},[[337,2,1]]]);
//# sourceMappingURL=main.a87e4aa8.chunk.js.map